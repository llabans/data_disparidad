---
title: "disparidad"
author: "L"
date: "2023-09-27"
output:
  html_document:
    keep_md: true
---



```r
#Paquetes

library(tidyverse)
```

```
## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.1     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.0
## ✔ ggplot2   3.4.2     ✔ tibble    3.2.1
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.1     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors
```

```r
library(rio)
library(zoo)
```

```
## 
## Attaching package: 'zoo'
## 
## The following objects are masked from 'package:base':
## 
##     as.Date, as.Date.numeric
```

```r
library(optimx)

data <- import("C:/Users/luisl/iCloudDrive/r/data_disparidad/data/data.xlsx") 
```

```
## New names:
## • `` -> `...3`
## • `` -> `...4`
## • `` -> `...6`
## • `` -> `...7`
## • `` -> `...9`
## • `` -> `...10`
## • `` -> `...12`
## • `` -> `...13`
## • `` -> `...15`
## • `` -> `...16`
## • `` -> `...18`
## • `` -> `...19`
## • `` -> `...21`
## • `` -> `...22`
## • `` -> `...24`
```



```r
#elimnar columnas

data_c <- data %>%
  select_if(~ !all(is.na(.)))

glimpse(data_c)
```

```
## Rows: 38
## Columns: 17
## $ departamento          <chr> NA, "Amazonas", "Ancash", "Apurimac", "Arequipa"…
## $ `población total`     <chr> "2003", "435556", "1123410", "470719", "1113916"…
## $ ...3                  <chr> "2012", "419404", "1135962", "454324", "1259162"…
## $ `nacidos vivos`       <dbl> 2003, 12631, 25951, 13086, 21721, 14755, 42292, …
## $ ...6                  <dbl> 2012, 9367, 22861, 10611, 21113, 16069, 32116, 2…
## $ `ingreso per cápita`  <dbl> 2003.0, 158.6, 254.3, 159.7, 465.0, 169.8, 233.6…
## $ ...9                  <dbl> 2012.0, 543.0, 703.9, 427.1, 1009.7, 475.1, 530.…
## $ `mortalidad infantil` <chr> "2003", "35.5", "36.700000000000003", "52", "33.…
## $ ...12                 <dbl> 2012.000000, 23.699295, 14.857411, 22.161614, 9.…
## $ `mortalidad niñez`    <dbl> 2003, 69, 72, 93, 58, 68, 69, 108, 108, 93, 32, …
## $ ...15                 <dbl> 2012.00000, 34.20001, 18.99967, 27.20609, 12.798…
## $ `incidencia TB`       <dbl> 2003.00000, 38.54285, 89.18352, 28.71758, 115.07…
## $ ...18                 <dbl> 2012.00000, 28.98148, 68.35542, 27.21956, 59.506…
## $ `médicos x hb`        <dbl> 2003.00, 3.77, 4.25, 3.63, 10.78, 4.56, 2.12, 3.…
## $ ...21                 <dbl> 2012.00, 6.91, 6.29, 9.55, 13.33, 6.58, 4.27, 7.…
## $ `esperanza de vida`   <dbl> 2003.0, 67.7, 70.1, 63.7, 73.1, 63.8, 68.9, 62.3…
## $ ...24                 <dbl> 2012.00, 70.56, 73.81, 70.23, 76.27, 70.81, 72.9…
```



```r
#filtrar data
data_c <- data_c %>% slice(2:25)
```


```r
# setear nombres de columnas
colnames(data_c) <- c("departmento", "pop_2003", "pop_2012", "nacidovivo_2003", "nacidovivo_2012", "ingresopc_2003", "ingresopc_2012", "mortinf_2003", "mortinf_2012",                     "mortniñez_2003", "mortniñez_2012", "incidtb_2003", "incidtb_2012",
                    "medxhb_2003","medxhb_2012", "esperanzavida_2003", "esperanzavida2012")

glimpse(data_c)
```

```
## Rows: 24
## Columns: 17
## $ departmento        <chr> "Amazonas", "Ancash", "Apurimac", "Arequipa", "Ayac…
## $ pop_2003           <chr> "435556", "1123410", "470719", "1113916", "561029",…
## $ pop_2012           <chr> "419404", "1135962", "454324", "1259162", "673609",…
## $ nacidovivo_2003    <dbl> 12631, 25951, 13086, 21721, 14755, 42292, 31682, 14…
## $ nacidovivo_2012    <dbl> 9367, 22861, 10611, 21113, 16069, 32116, 26139, 140…
## $ ingresopc_2003     <dbl> 158.6, 254.3, 159.7, 465.0, 169.8, 233.6, 225.2, 14…
## $ ingresopc_2012     <dbl> 543.0, 703.9, 427.1, 1009.7, 475.1, 530.4, 701.6, 4…
## $ mortinf_2003       <chr> "35.5", "36.700000000000003", "52", "33.6", "44.6",…
## $ mortinf_2012       <dbl> 23.699295, 14.857411, 22.161614, 9.756409, 22.88042…
## $ mortniñez_2003     <dbl> 69, 72, 93, 58, 68, 69, 108, 108, 93, 32, 62, 60, 4…
## $ mortniñez_2012     <dbl> 34.20001, 18.99967, 27.20609, 12.79857, 29.47011, 2…
## $ incidtb_2003       <dbl> 38.54285, 89.18352, 28.71758, 115.07668, 72.08339, …
## $ incidtb_2012       <dbl> 28.98148, 68.35542, 27.21956, 59.50608, 32.73131, 1…
## $ medxhb_2003        <dbl> 3.77, 4.25, 3.63, 10.78, 4.56, 2.12, 3.94, 2.30, 3.…
## $ medxhb_2012        <dbl> 6.91, 6.29, 9.55, 13.33, 6.58, 4.27, 7.62, 7.43, 4.…
## $ esperanzavida_2003 <dbl> 67.7, 70.1, 63.7, 73.1, 63.8, 68.9, 62.3, 59.1, 66.…
## $ esperanzavida2012  <dbl> 70.56, 73.81, 70.23, 76.27, 70.81, 72.94, 70.31, 69…
```



```r
# formato numerico...
data_c <- data_c %>% mutate(across(-departmento, as.numeric))
glimpse(data_c)
```

```
## Rows: 24
## Columns: 17
## $ departmento        <chr> "Amazonas", "Ancash", "Apurimac", "Arequipa", "Ayac…
## $ pop_2003           <dbl> 435556, 1123410, 470719, 1113916, 561029, 1515827, …
## $ pop_2012           <dbl> 419404, 1135962, 454324, 1259162, 673609, 1519764, …
## $ nacidovivo_2003    <dbl> 12631, 25951, 13086, 21721, 14755, 42292, 31682, 14…
## $ nacidovivo_2012    <dbl> 9367, 22861, 10611, 21113, 16069, 32116, 26139, 140…
## $ ingresopc_2003     <dbl> 158.6, 254.3, 159.7, 465.0, 169.8, 233.6, 225.2, 14…
## $ ingresopc_2012     <dbl> 543.0, 703.9, 427.1, 1009.7, 475.1, 530.4, 701.6, 4…
## $ mortinf_2003       <dbl> 35.5, 36.7, 52.0, 33.6, 44.6, 42.1, 49.3, 52.4, 44.…
## $ mortinf_2012       <dbl> 23.699295, 14.857411, 22.161614, 9.756409, 22.88042…
## $ mortniñez_2003     <dbl> 69, 72, 93, 58, 68, 69, 108, 108, 93, 32, 62, 60, 4…
## $ mortniñez_2012     <dbl> 34.20001, 18.99967, 27.20609, 12.79857, 29.47011, 2…
## $ incidtb_2003       <dbl> 38.54285, 89.18352, 28.71758, 115.07668, 72.08339, …
## $ incidtb_2012       <dbl> 28.98148, 68.35542, 27.21956, 59.50608, 32.73131, 1…
## $ medxhb_2003        <dbl> 3.77, 4.25, 3.63, 10.78, 4.56, 2.12, 3.94, 2.30, 3.…
## $ medxhb_2012        <dbl> 6.91, 6.29, 9.55, 13.33, 6.58, 4.27, 7.62, 7.43, 4.…
## $ esperanzavida_2003 <dbl> 67.7, 70.1, 63.7, 73.1, 63.8, 68.9, 62.3, 59.1, 66.…
## $ esperanzavida2012  <dbl> 70.56, 73.81, 70.23, 76.27, 70.81, 72.94, 70.31, 69…
```
## 


```r
# Convertir datos a formato largo
data_long <- data_c %>%  
  pivot_longer(
    cols = -departmento, 
    names_to = "variable", 
    values_to = "valor"
  ) %>% 
  separate(variable, into = c('tipo', 'anio'), sep = '_') %>% 
  pivot_wider(names_from = tipo, values_from = valor)
```

```
## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 24 rows [16, 32, 48, 64,
## 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 272, 288, 304, 320,
## ...].
```

```r
glimpse(data_long)
```

```
## Rows: 72
## Columns: 11
## $ departmento       <chr> "Amazonas", "Amazonas", "Amazonas", "Ancash", "Ancas…
## $ anio              <chr> "2003", "2012", NA, "2003", "2012", NA, "2003", "201…
## $ pop               <dbl> 435556, 419404, NA, 1123410, 1135962, NA, 470719, 45…
## $ nacidovivo        <dbl> 12631, 9367, NA, 25951, 22861, NA, 13086, 10611, NA,…
## $ ingresopc         <dbl> 158.6, 543.0, NA, 254.3, 703.9, NA, 159.7, 427.1, NA…
## $ mortinf           <dbl> 35.500000, 23.699295, NA, 36.700000, 14.857411, NA, …
## $ mortniñez         <dbl> 69.00000, 34.20001, NA, 72.00000, 18.99967, NA, 93.0…
## $ incidtb           <dbl> 38.54285, 28.98148, NA, 89.18352, 68.35542, NA, 28.7…
## $ medxhb            <dbl> 3.77, 6.91, NA, 4.25, 6.29, NA, 3.63, 9.55, NA, 10.7…
## $ esperanzavida     <dbl> 67.7, NA, NA, 70.1, NA, NA, 63.7, NA, NA, 73.1, NA, …
## $ esperanzavida2012 <dbl> NA, NA, 70.56, NA, NA, 73.81, NA, NA, 70.23, NA, NA,…
```



```r
#explorar datos
data <- import("C:/Users/luisl/iCloudDrive/r/data_disparidad/data/data.xlsx")
```

```
## New names:
## • `` -> `...3`
## • `` -> `...4`
## • `` -> `...6`
## • `` -> `...7`
## • `` -> `...9`
## • `` -> `...10`
## • `` -> `...12`
## • `` -> `...13`
## • `` -> `...15`
## • `` -> `...16`
## • `` -> `...18`
## • `` -> `...19`
## • `` -> `...21`
## • `` -> `...22`
## • `` -> `...24`
```

```r
glimpse(data_c)
```

```
## Rows: 24
## Columns: 17
## $ departmento        <chr> "Amazonas", "Ancash", "Apurimac", "Arequipa", "Ayac…
## $ pop_2003           <dbl> 435556, 1123410, 470719, 1113916, 561029, 1515827, …
## $ pop_2012           <dbl> 419404, 1135962, 454324, 1259162, 673609, 1519764, …
## $ nacidovivo_2003    <dbl> 12631, 25951, 13086, 21721, 14755, 42292, 31682, 14…
## $ nacidovivo_2012    <dbl> 9367, 22861, 10611, 21113, 16069, 32116, 26139, 140…
## $ ingresopc_2003     <dbl> 158.6, 254.3, 159.7, 465.0, 169.8, 233.6, 225.2, 14…
## $ ingresopc_2012     <dbl> 543.0, 703.9, 427.1, 1009.7, 475.1, 530.4, 701.6, 4…
## $ mortinf_2003       <dbl> 35.5, 36.7, 52.0, 33.6, 44.6, 42.1, 49.3, 52.4, 44.…
## $ mortinf_2012       <dbl> 23.699295, 14.857411, 22.161614, 9.756409, 22.88042…
## $ mortniñez_2003     <dbl> 69, 72, 93, 58, 68, 69, 108, 108, 93, 32, 62, 60, 4…
## $ mortniñez_2012     <dbl> 34.20001, 18.99967, 27.20609, 12.79857, 29.47011, 2…
## $ incidtb_2003       <dbl> 38.54285, 89.18352, 28.71758, 115.07668, 72.08339, …
## $ incidtb_2012       <dbl> 28.98148, 68.35542, 27.21956, 59.50608, 32.73131, 1…
## $ medxhb_2003        <dbl> 3.77, 4.25, 3.63, 10.78, 4.56, 2.12, 3.94, 2.30, 3.…
## $ medxhb_2012        <dbl> 6.91, 6.29, 9.55, 13.33, 6.58, 4.27, 7.62, 7.43, 4.…
## $ esperanzavida_2003 <dbl> 67.7, 70.1, 63.7, 73.1, 63.8, 68.9, 62.3, 59.1, 66.…
## $ esperanzavida2012  <dbl> 70.56, 73.81, 70.23, 76.27, 70.81, 72.94, 70.31, 69…
```
